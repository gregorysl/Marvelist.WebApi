<div class="jumbotron">
    <h1>ASP.NET</h1>
    <p class="lead">ASP.NET is a free web framework for building great Web sites and Web applications using HTML, CSS, and JavaScript.</p>
    <p><a href="http://asp.net" class="btn btn-primary btn-lg">Learn more &raquo;</a></p>
</div>
<div class="row">
    <div class="col-sm-4">
        <form id="register">
            <h3>Register</h3>
            <div class="form-group">
                <label>Email</label>
                <input class="form-control" type="text" id="register-email" />
            </div>
            <div class="form-group">
                <label>Password</label>
                <input class="form-control" type="password" id="register-password" />
            </div>
            <div class="form-group">
                <label>Confirm Password</label>
                <input class="form-control" type="password" id="register-password2" />
            </div>
            <div class="form-group">
                <button id="register-submit" class="btn btn-default">Register</button>
            </div>
        </form>
    </div>
    <div class="col-sm-4">
        <h3>Log In</h3>
        <form id="login">
            <div class="form-group">
                <label>Email</label>
                <input class="form-control" type="text" id="login-email" />
            </div>
            <div class="form-group">
                <label>Password</label>
                <input class="form-control" type="password" id="login-password" />
            </div>
            <div class="form-group">
                <button type="submit" id="login-submit" class="btn btn-default">Log In</button>
                @*<button data-bind="click: logout" class="btn btn-default">Log Out</button>*@
            </div>
        </form>
    </div>
</div>
@section scripts{

    <script type="text/javascript">
        var tokenKey = 'accessToken';
        $('#register-submit').click(function() {
            var data = {
                Email: $('#register-email').val(),
                Password: $('#register-password').val(),
                ConfirmPassword: $('#register-password2').val()
            };

            $.ajax({
                type: 'POST',
                url: '/api/Account/Register',
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify(data)
            }).done(function(data) {
                alert("Done!");
            }).fail(function(a) { console.log(a.responseText); });
        });

        $('#login-submit').click(function() {
            var loginData = {
                grant_type: 'password',
                username: $('#login-email').val(),
                password: $('#login-password').val()
            };

            $.ajax({
                type: 'POST',
                url: '/Token',
                data: loginData
            }).done(function(data) {
                self.user(data.userName);
                // Cache the access token in session storage.
                sessionStorage.setItem(tokenKey, data.access_token);
            }).fail(function (a) { console.log(a.responseText); });
        });
    </script>
}